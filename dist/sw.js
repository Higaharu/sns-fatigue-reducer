(()=>{"use strict";({888:function(){var e=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(o,n){function c(e){try{a(r.next(e))}catch(e){n(e)}}function i(e){try{a(r.throw(e))}catch(e){n(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(c,i)}a((r=r.apply(e,t||[])).next())}))};const t={enabled:!0,fatigueThreshold:70,resetTime:24,sites:{"twitter.com":!0,"x.com":!0,"facebook.com":!0,"instagram.com":!0},blurIntensity:5,summaryApiUrl:"https://api.example.com/summarize"};chrome.runtime.onInstalled.addListener((()=>{chrome.storage.local.get(["settings"],(e=>{e.settings||chrome.storage.local.set({settings:t})}))})),chrome.runtime.onMessage.addListener(((s,r,o)=>{switch(s.type){case"GET_SUMMARY":return function(s,r){return e(this,void 0,void 0,(function*(){const{settings:e}=yield chrome.storage.local.get(["settings"]),o=(null==e?void 0:e.summaryApiUrl)||t.summaryApiUrl;try{const e=yield fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:s,url:r,max_length:300})});if(!e.ok)throw new Error(`API error: ${e.status}`);return(yield e.json()).summary||"要約を取得できませんでした。"}catch(e){return console.error("Summary API error:",e),"要約の取得中にエラーが発生しました。"}}))}(s.content,s.url).then((e=>{o({summary:e})})).catch((e=>{console.error("Summary API error:",e),o({error:"API error"})})),!0;case"CONTENT_DATA":chrome.tabs.query({active:!0,currentWindow:!0},(e=>{var t;(null===(t=e[0])||void 0===t?void 0:t.id)&&chrome.tabs.sendMessage(e[0].id,{type:"CONTENT_DATA",content:s.content,url:s.url})})),o({success:!0});break;case"SETTINGS_UPDATED":chrome.tabs.query({active:!0,currentWindow:!0},(e=>{var t;(null===(t=e[0])||void 0===t?void 0:t.id)&&chrome.tabs.sendMessage(e[0].id,{type:"UPDATE_SETTINGS",settings:s.settings})})),o({success:!0});break;case"TOGGLE_EXTENSION":chrome.storage.local.get(["settings"],(e=>{const r=e.settings||t;r.enabled=s.enabled,chrome.storage.local.set({settings:r}),chrome.tabs.query({},(e=>{e.forEach((e=>{e.id&&chrome.tabs.sendMessage(e.id,{type:"UPDATE_SETTINGS",settings:r}).catch((()=>{}))}))}))})),o({success:!0})}return!1})),function(){e(this,void 0,void 0,(function*(){const{settings:s}=yield chrome.storage.local.get(["settings"]),r=(null==s?void 0:s.resetTime)||t.resetTime;setInterval((()=>e(this,void 0,void 0,(function*(){const{lastReset:e}=yield chrome.storage.local.get(["lastReset"]),t=Date.now();(!e||t-e>60*r*60*1e3)&&(yield chrome.storage.local.set({stats:{},lastReset:t}),console.log("Stats reset completed"))}))),36e5)}))}()}})[888]()})();